Taken from here: https://github.com/shovon/stream-wrapper